<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Better Ark Server Manager</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <div class="brand">
      <img src="./assets/logo.png" alt="Better Ark" class="logo" onerror="this.remove()" />
      <h1>Better Ark Server Manager</h1>
    </div>
    <div class="theme-toggle">
      <span>Dark mode</span>
      <div id="themeToggle" class="toggle" title="Toggle dark mode"></div>
    </div>
  </header>
  <nav class="tabs">
    <button data-tab="dashboard" class="active">Dashboard</button>
    <button data-tab="install">Install/Update</button>
    <button data-tab="mods">Mods</button>
    <button data-tab="settings">Settings</button>
    <button data-tab="advanced">Advanced</button>
    <button data-tab="logs">Logs</button>
  </nav>

  <main>
    <section id="dashboard" class="tab active">
      <div class="dashboard-grid">
        <div class="card kpi">
          <div class="kpi-header">
            <h3 style="margin:0; display:flex; align-items:center; gap:8px;">
              <img src="./assets/logo.png" alt="logo" style="width:26px; height:26px; object-fit:contain; opacity:.9" onerror="this.remove()"/>
              Server Status
            </h3>
            <span id="serverStatusPill" class="pill unknown">Unknown</span>
          </div>
          <div class="row">
            <button id="startServerBtn" class="btn primary">Start</button>
            <button id="stopServerBtn" class="btn">Stop</button>
            <span id="serverStatus" class="muted">Status: Unknown</span>
          </div>
        </div>

        <div class="card kpi">
          <div class="kpi-header">
            <h3 style="margin:0">SteamCMD</h3>
          </div>
          <div class="row">
            <button id="ensureSteamcmd" class="btn">Install/Verify SteamCMD</button>
            <span id="steamcmdPath" class="muted"></span>
          </div>
          <div class="row">
            <button id="checkUpdatesBtn" class="btn">Check for updates</button>
            <span id="updateInfo" class="muted"></span>
          </div>
        </div>
      </div>
    </section>

    <section id="install" class="tab">
      <h2>Install / Update</h2>
      <div class="card">
        <div>
          <label>Branch:
            <select id="branch">
              <option value="stable">Stable</option>
              <option value="beta">Beta</option>
            </select>
          </label>
        </div>
        <div class="row">
          <label style="flex:1">Server Install Path
            <input id="installPath" placeholder="Choose a folder" />
          </label>
          <button id="browseInstallPath" class="btn">Browse</button>
          <button id="saveInstallPath" class="btn">Save</button>
        </div>
        <div class="row">
          <button id="installServerBtn" class="btn primary">Install</button>
          <button id="updateServerBtn" class="btn">Update Now</button>
        </div>
        <div id="installProgressRow" class="progress-row hidden">
          <progress id="installProgress" max="100" value="0" style="width:320px;"></progress>
          <span id="installProgressMsg" class="muted"></span>
          <span id="installSpeedEta" class="badge hidden"></span>
          <button id="cancelInstall" class="btn danger" title="Cancel ongoing install/update">Cancel</button>
        </div>
  <!-- quick controls moved to dashboard; keeping here is optional, remove duplicates to avoid confusion -->
      </div>
    </section>

    <section id="mods" class="tab">
      <h2>Mods</h2>
      <div class="card">
        <div class="row">
          <input id="modIdInput" placeholder="Enter Workshop ID (e.g., 1234567890)" />
          <button id="addModById">Add Mod by ID</button>
        </div>
        <div id="modProgressRow" class="progress-row hidden">
          <progress id="modProgress" max="100" value="0" style="width:320px;"></progress>
          <span id="modProgressMsg" class="muted"></span>
          <span id="modSpeedEta" class="badge hidden"></span>
          <button id="cancelMod" class="btn danger" title="Cancel current mod task">Cancel</button>
        </div>
        <div id="installedMods" class="list"></div>
        <h3>Active Mods</h3>
        <div id="modsState" class="list"></div>
        <div class="row">
          <button id="saveActiveMods">Save Active Mods to INI</button>
        </div>
      </div>
    </section>

    <section id="settings" class="tab">
      <h2>Settings</h2>
      <div class="card">
      <div class="list">
        <div class="result">
          <label>Map
            <select id="cfgMap">
              <option value="TheIsland">TheIsland</option>
              <option value="TheCenter">TheCenter</option>
              <option value="ScorchedEarth_P">ScorchedEarth</option>
              <option value="Ragnarok">Ragnarok</option>
              <option value="Aberration_P">Aberration</option>
              <option value="Extinction">Extinction</option>
              <option value="Valguero_P">Valguero</option>
              <option value="Genesis">Genesis</option>
              <option value="CrystalIsles">CrystalIsles</option>
              <option value="LostIsland">LostIsland</option>
              <option value="Fjordur">Fjordur</option>
            </select>
          </label>
        </div>
        <div class="result">
          <label>Session Name
            <input id="cfgSessionName" placeholder="My Ark Server" />
          </label>
        </div>
        <div class="result">
          <label>Port
            <input id="cfgPort" type="number" min="1" max="65535" />
            <small class="hint">Default: 7777 (UDP). Make sure it is open on your firewall/router.</small>
          </label>
          <label>Query Port
            <input id="cfgQueryPort" type="number" min="1" max="65535" />
            <small class="hint">Default: 27015 (UDP). Used by server browser.</small>
          </label>
        </div>
        <div class="result">
          <label>
            <input id="cfgRconEnabled" type="checkbox" /> Enable RCON
          </label>
          <label>RCON Port
            <input id="cfgRconPort" type="number" min="1" max="65535" />
            <small class="hint">Default: 27020 (TCP). Required if RCON is enabled.</small>
          </label>
        </div>
        <div class="result">
          <label>Max Players
            <input id="cfgMaxPlayers" type="number" min="1" max="255" />
            <small class="hint">Typical: 10â€“70. Higher values need more CPU/RAM.</small>
          </label>
        </div>
        <div class="result">
          <label>Server Password
            <input id="cfgServerPassword" type="password" autocomplete="new-password" />
            <small class="hint">Leave blank for no password.</small>
          </label>
          <label>Admin Password
            <input id="cfgServerAdminPassword" type="password" autocomplete="new-password" />
            <small class="hint">Used for admin commands.</small>
          </label>
        </div>
        <div class="result">
          <label>
            <input id="cfgServerPVE" type="checkbox" /> Server PVE
          </label>
          <label>
            <input id="cfgNoBattlEye" type="checkbox" /> Disable BattlEye
          </label>
        </div>
      </div>
  <div class="row">
        <button id="saveSettings" class="btn primary">Save Settings</button>
        <span id="settingsStatus" class="muted"></span>
      </div>
  </div>
    </section>

    <section id="advanced" class="tab">
      <h2>Advanced</h2>
      <div class="card">
        <p>Raw INI editor coming later.</p>
      </div>
    </section>

    <section id="logs" class="tab">
      <h2>Logs</h2>
      <div class="card">
        <div class="row"><button id="clearLogs">Clear</button></div>
        <pre id="logsOutput">Logs will appear here.</pre>
      </div>
    </section>
  </main>

  <script src="renderer.js"></script>
</body>
</html>
